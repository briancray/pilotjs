(function(l,d){var t=document;var h=t.head||t.getElementsByTagName("head")[0]||t.documentElement;var k=(function(u){return u[u.length-1]})(t.getElementsByTagName("script"));var e=k.getAttribute("data-main");var n=[];var r=n.slice;var b=n.forEach;var o={baseUrl:(function(w){var u=w.protocol+"//"+w.host+"/";var v;if(e){if(e.slice(0,u.length)===u){v=e}else{v=u+e}e=e.slice(e.lastIndexOf("/")+1)}else{v=u}return v.slice(0,v.lastIndexOf("/")+1)})(l.location),viewsPath:"views/",viewContext:t.body||t.getElementsByTagName("body")[0]||t.documentElement};var q={};function p(u){return typeof u==="string"?o[u]:m(o,u)}function a(y,x,u){var w=arguments.length;if(w===1){u=y;x=["require","exports","module"];y=null}else{if(w===2){if(o.toString.call(y)==="[object Array]"){u=x;x=y;y=null}else{u=x;x=["require","exports","module"]}}}if(!y){n.push([x,u]);return}function v(){var A,C,B;if(q[y]){A=q[y].handlers;C=q[y].context}B=q[y]=typeof u==="function"?u.apply(null,n.slice.call(arguments,0))||q[y]||{}:u;B.pilot=2;B.context=C;for(var z=0,D=A?A.length:0;z<D;z++){A[z](B)}}g(x,v,y)}a.amd={jQuery:true};function g(w,C,u){var A=[],z=0,D=false;if(typeof w==="string"){if(q[w]&&q[w].pilot===2){return q[w]}throw new Error(w+" has not been defined. Please include it as a dependency in "+u+"'s define()");return}for(var B=0,y=w.length;B<y;B++){switch(w[B]){case"require":var v=function(x,E){return g(x,E,u)};v.toUrl=function(x){return j(x,u)};A[B]=v;z++;break;case"exports":A[B]=q[u]||(q[u]={});z++;break;case"module":A[B]={id:u,uri:j(u)};z++;break;case q[u]?q[u].context:"":A[B]=q[q[u].context];z++;break;default:(function(E){f(w[E],function(x){A[E]=x;z++;z===y&&C&&(D=true,C.apply(null,A))},u)})(B)}}!D&&z===y&&C&&C.apply(null,A)}function f(v,w,u){v=u?j(v,u):v;if(q[v]){if(q[v].pilot===1){w&&q[v].handlers.push(w)}else{w&&w(q[v])}return}else{q[v]={pilot:1,handlers:[w],context:u}}i(j(v)+".js",function(){var x;if(x=n.shift()){x.unshift(v);q[v].pilot===1&&a.apply(null,x)}})}var j=g.toUrl=function(y,v){var w,u,x;switch(y){case"require":case"exports":case"module":return y}w=(v||o.baseUrl).split("/");w.pop();y=y.split("/");u=y.length;while(--u){switch(y[0]){case"..":w.pop();case".":case"":y.shift();x=true}}return(w.length&&x?w.join("/")+"/":"")+y.join("/")};function i(v,w){var u=t.createElement("script");u.onload=u.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){u.onload=u.onreadystatechange=null;h.removeChild(u);w&&w()}};u.type="text/javascript";u.async=true;u.src=v;h.appendChild(u)}function m(z,y){var w=r.call(arguments,1);var v=w.length;while(v-->-1){for(var u in w[v]){w[v].hasOwnProperty(u)&&(z[u]=w[v][u])}}return z}function s(u){return pilot.toString.call(u).slice(8,-1)}function c(u){return(u||"instance")+"_"+Date.now()+"."+(Math.floor(Math.random()*900000)+100000)}l.pilot={config:p,inject:i,define:l.define=a,require:l.require=g,exports:q,get_type:s,extend:m,generate_id:c};e&&g([e])})(window);define("pilot/model",[],function(){var f=pilot.extend;var e=JSON;var c=e.parse;var a=e.stringify;var b={};function d(){}d.prototype={init:function(h,g){if(typeof h==="string"){this.id=h;if(b[h]){this.synced=true;this.data=b[h]}else{this.synced=false;this.data=b[h]=g||{};this.sync()}}else{this.data=h||{}}return this},set:function(g,h){if(typeof g==="string"){this.data[g]=h}else{f(this.data,g)}this.sync();return this},get:function(j,h){var l,k,i;if(!j||typeof j!=="string"){return this.data}else{if(j.indexOf(".")===-1){return this.data[j]}}l=j.split("."),k=l[g],i=this.data;for(var g=0,m=l.length;g<m;k=l[++g]){i=i[k];if(typeof i==="undefined"){return h}}return i},remove:function(g){g&&typeof g==="string"?(delete this.data[g]):(this.data={});this.sync();return this},destroy:function(){this.data=null;this.sync()},sync:function(){var g;if(!this.id){return}else{if(this.synced){if(this.data){localStorage.setItem("data."+this.id,a(this.data));b[this.id]=this.data}else{localStorage.removeItem("data."+this.id);delete b[this.id]}}else{g=localStorage.getItem("data"+this.id);g?(this.data=b[this.id]=c(g)||{}):(this.data=b[this.data]={});this.synced=true}}}};return d});define("pilot/pubsub",[],function(){var d=Array.prototype.slice;var c={};var b=Date.now;function a(){}a.prototype={init:function(e){this.id=typeof e==="string"?e:pilot.generate_id("pubsub");this.handlers={};return c[this.id]=this},on:function(i,h,f){f=typeof f==="undefined"?true:f;var g=this.handlers[i]||(this.handlers[i]=[]);g.push({handler:h,retain:f});return this},one:function(g,f){return this.on(g,f,false)},off:function(f){if(f&&typeof f==="string"){this.handlers[f]=[]}else{if(typeof f==="undefined"){this.handlers={}}}return this},trigger:function(i){var f,g,h;if((h=i.indexOf(".local"))!==-1){g=d.call(arguments,1);i=i.slice(0,h);f=this.handlers[i];if(f&&f.length){this.handlers[i]=f.filter(function(e){return e.handler.apply(null,g),e.retain})}}else{g=d.call(arguments,0);a.trigger.apply(null,g)}return this},destroy:function(f){c[this.id]=null}};a.trigger=function(){var e,f;e=d.call(arguments,0);e[0]=e[0]+".local";for(f in c){c.hasOwnProperty(f)&&c[f].trigger.apply(c[f],e)}};return a});define("pilot/view",["pilot/pubsub","pilot/model"],function(c,b){var d=Array.prototype.forEach;var e=[];function a(){}a.prototype={init:function(f,g){this.el=f;this.id=f.getAttribute("data-view")||"";e.push(this);this.params=g;this.events=new c().init(this.id);this.model=new b().init(this.id);this.app_events();this.dom_events();this.render();this.init_subviews();return this},app_events:function(){},dom_events:function(){},init_subviews:function(){pilot.render(this.el,this.params)},render:function(){this.el.innerHTML=""},destroy:function(){this.events.destroy()}};a.load=function(g,h){g=g||"body";g=typeof g==="string"?doc.querySelector(g):g;h=typeof h==="object"?h:{};var f={};window.location.search.slice(1).split("&").forEach(function(j){var i=j.split("=");f[decodeURIComponent(i[0])]=decodeURIComponent(i.slice(1).join(""))});h=pilot.extend(f,h);d.call(g.getElementsByClassName("view"),function(i){var j=i.getAttribute("data-view")||"";j&&require([j.split(".")[0]],function(k){new k().init(i,h)})})};a.unload=function(f){f=f||"body";f=typeof f==="string"?doc.querySelector(f):f;e=e.filter(function(g){if(f.contains(g.el)){g.destroy();return false}return true})};return a});
