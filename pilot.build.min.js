(function(k,c){var s=document;var g=s.head||s.getElementsByTagName("head")[0]||s.documentElement;var j=(function(t){return t[t.length-1]})(s.getElementsByTagName("script"));var d=j.getAttribute("data-main");var m=[];var q=Array.prototype.slice;var n={baseUrl:(function(v){var t=v.protocol+"//"+v.host+"/";var u;if(d){if(d.slice(0,t.length)===t){u=d}else{u=t+d}d=d.slice(d.lastIndexOf("/")+1)}else{u=t}return u.slice(0,u.lastIndexOf("/")+1)})(k.location),viewsPath:"views/",viewContext:s.body||s.getElementsByTagName("body")[0]||s.documentElement};var p={};function o(t){return typeof t==="string"?n[t]:l(n,t)}function a(x,w,t){var v=arguments.length;if(v===1){t=x;w=["require","exports","module"];x=null}else{if(v===2){if(n.toString.call(x)==="[object Array]"){t=w;w=x;x=null}else{t=w;w=["require","exports","module"]}}}if(!x){m.push([w,t]);return}function u(){var z,B,A;if(p[x]){z=p[x].handlers;B=p[x].context}A=p[x]=typeof t==="function"?t.apply(null,m.slice.call(arguments,0))||p[x]||{}:t;A.pilot=2;A.context=B;for(var y=0,C=z?z.length:0;y<C;y++){z[y](A)}}f(w,u,x)}a.amd={jQuery:true};function f(v,B,t){var z=[],y=0,C=false;if(typeof v==="string"){if(p[v]&&p[v].pilot===2){return p[v]}throw new Error(v+" has not been defined. Please include it as a dependency in "+t+"'s define()");return}for(var A=0,w=v.length;A<w;A++){switch(v[A]){case"require":var u=function(x,D){return f(x,D,t)};u.toUrl=function(x){return i(x,t)};z[A]=u;y++;break;case"exports":z[A]=p[t]||(p[t]={});y++;break;case"module":z[A]={id:t,uri:i(t)};y++;break;case p[t]?p[t].context:"":z[A]=p[p[t].context];y++;break;default:(function(D){e(v[D],function(x){z[D]=x;y++;y===w&&B&&(C=true,B.apply(null,z))},t)})(A)}}!C&&y===w&&B&&B.apply(null,z)}function e(u,v,t){u=t?i(u,t):u;if(p[u]){if(p[u].pilot===1){v&&p[u].handlers.push(v)}else{v&&v(p[u])}return}else{p[u]={pilot:1,handlers:[v],context:t}}h(i(u)+".js",function(){var w;if(w=m.shift()){w.unshift(u);p[u].pilot===1&&a.apply(null,w)}})}var i=f.toUrl=function(x,u){var v,t,w;switch(x){case"require":case"exports":case"module":return x}v=(u||n.baseUrl).split("/");v.pop();x=x.split("/");t=x.length;while(--t){switch(x[0]){case"..":v.pop();case".":case"":x.shift();w=true}}return(v.length&&w?v.join("/")+"/":"")+x.join("/")};function h(u,v){var t=s.createElement("script");t.onload=t.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){t.onload=t.onreadystatechange=null;g.removeChild(t);v&&v()}};t.type="text/javascript";t.async=true;t.src=u;g.appendChild(t)}function l(y,w){var v=q.call(arguments,1);var u=v.length;while(u-->-1){for(var t in v[u]){v[u].hasOwnProperty(t)&&(y[t]=v[u][t])}}return y}function r(t){return pilot.toString.call(t).slice(8,-1)}function b(t){return(t||"instance")+"_"+Date.now()+"."+(Math.floor(Math.random()*900000)+100000)}k.pilot={config:o,inject:h,define:k.define=a,require:k.require=f,exports:p,get_type:r,extend:l,generate_id:b};d&&f([d])})(window);define("pilot/model",[],function(){var f=pilot.extend;var e=JSON;var c=e.parse;var a=e.stringify;var b={};function d(){}d.prototype={init:function(h,g){if(typeof h==="string"){this.id=h;if(b[h]){this.synced=true;this.data=b[h]}else{this.synced=false;this.data=b[h]=g||{};this.sync()}}else{this.data=h||{}}return this},set:function(g,h){if(typeof g==="string"){this.data[g]=h}else{f(this.data,g)}this.sync();return this},get:function(j,h){var l,k,i;if(!j||typeof j!=="string"){return this.data}else{if(j.indexOf(".")===-1){return this.data[j]}}l=j.split("."),k=l[g],i=this.data;for(var g=0,m=l.length;g<m;k=l[++g]){i=i[k];if(typeof i==="undefined"){return h}}return i},remove:function(g){g&&typeof g==="string"?(delete this.data[g]):(this.data={});this.sync();return this},destroy:function(){this.data=null;this.sync()},sync:function(){var g;if(!this.id){return}else{if(this.synced){if(this.data){localStorage.setItem("data."+this.id,a(this.data));b[this.id]=this.data}else{localStorage.removeItem("data."+this.id);delete b[this.id]}}else{g=localStorage.getItem("data"+this.id);g?(this.data=b[this.id]=c(g)||{}):(this.data=b[this.data]={});this.synced=true}}}};return d});define("pilot/pubsub",[],function(){var d=Array.prototype.slice;var c={};var b=Date.now;function a(){}a.prototype={init:function(e){this.id=typeof e==="string"?e:pilot.generate_id("pubsub");this.handlers={};return c[this.id]=this},on:function(i,h,f){f=typeof f==="undefined"?true:f;var g=this.handlers[i]||(this.handlers[i]=[]);g.push({handler:h,retain:f});return this},one:function(g,f){return this.on(g,f,false)},off:function(f){if(f&&typeof f==="string"){this.handlers[f]=[]}else{if(typeof f==="undefined"){this.handlers={}}}return this},trigger:function(i){var f,g,h;if((h=i.indexOf(".local"))!==-1){g=d.call(arguments,1);i=i.slice(0,h);f=this.handlers[i];if(f&&f.length){this.handlers[i]=f.filter(function(e){return e.handler.apply(null,g),e.retain})}}else{g=d.call(arguments,0);a.trigger.apply(null,g)}return this},destroy:function(f){c[this.id]=null}};a.trigger=function(){var e,f;e=d.call(arguments,0);e[0]=e[0]+".local";for(f in c){c.hasOwnProperty(f)&&c[f].trigger.apply(c[f],e)}};return a});define("pilot/router",["pilot/pubsub"],function(g){var b=window;var e=b.location;var h=e.protocol+"//"+e.host+"/";var d=h.length;var f=b.history;var c=pilot.get_type;var i=[];var a={uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,query_parser:/(?:^|&)([^&=]*)=?([^&]*)/g,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"]};var k=new g;if(f&&f.pushState){b.onpopstate=function(){j.run(e.href)};document.addEventListener("click",function(n){var m=n.target;var l=m.href;var o;if(l&&l.indexOf("#")!==0&&l.slice(0,d)===h){o=m.getAttribute("data-bypass");if((o&&o==="true")||n.defaultPrevented||n.metaKey||n.ctrlKey||n.shiftKey||n.altKey){return}n.preventDefault();j.run(l);f.pushState(j.parse(l),null,l)}})}var j={add:function(l){if(c(l)==="Array"){i.push.apply(i,l)}else{i.push(l)}return j},get:function(m){var n=j.parse(m);var l=i.filter(function(p){return p.route&&p.route.test(n.path)})[0];var o;if(l){l.params=n.params;o=n.path.match(l.route).slice(1);if(o&&o.length&&l.matches.length){o.forEach(function(p){l.params[l.matches[p]]=decodeURIComponent(o[p])})}}return l},run:function(m){var l=j.get(m);if(l){k.trigger("unload",l.params);l.callback(l.params);k.trigger("load",l.params)}return j},parse:function(p){var n=a.key;var o=a.uri_parser.exec(p);var m={params:{}};var l=14;while(l--){m[n[l]]=o[l]||""}m[n[12]].replace(a.query_parser,function(r,q,s){q&&(m.params[q]=decodeURIComponent(s))});return m}};return j});define("pilot/view",["pilot/pubsub","pilot/model"],function(c,b){var d=Array.prototype.forEach;function a(){}a.prototype={init:function(e,f){this.el=e;this.id=e.getAttribute("data-view")||"";this.id=this.id.indexOf("!")!==-1?this.id.split("!")[0]:this.id;this.params=f;this.events=new c().init(this.id);this.model=new b().init(this.id);this.app_events();this.dom_events();this.render();return this},app_events:function(){},dom_events:function(){},render:function(){this.el.innerHTML=this.generate();this.init_subviews()},generate:function(){return""},init_subviews:function(f){var e=this;d.call(e.el.getElementsByClassName("view"),function(g){var h=g.getAttribute("data-view")||"";if(h){h=h.indexOf("!")!==-1?h.split("!")[1]:h;require([h],function(i){new i().init(g,e.params)})}})},destroy:function(){this.events.destroy()}};return a});
